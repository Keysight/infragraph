components:
  schemas:
    NameValue:
      type: object
      properties:
        name:
          type: string
          x-field-uid: 1
        value:
          type: string
          x-field-uid: 2
    QueryResponseItem:
      type: object
      properties:
        id:
          type: string
          x-field-uid: 1
        attributes:
          type: array
          items:
            $ref: "#/components/schemas/NameValue"
          x-field-uid: 2
    QueryShortestPathItem:
      type: object
      required:
        - name
        - nodes
      properties:
        name:
          description: |-
            Name of the shortest path filter
          type: string
          x-field-uid: 1
        nodes:
          description: |-
            An array of node ids that make up the shortest path
          type: array
          items:
            type: string
          x-field-uid: 2
    QueryResponseContent:
      type: object
      properties:
        choice:
          type: string
          x-enum:
            node_matches:
              x-field-uid: 1
            shortest_path_matches:
              x-field-uid: 2
          x-field-uid: 1
        node_matches:
          type: array
          items:
            $ref: "#/components/schemas/QueryResponseItem"
          x-field-uid: 2
        shortest_path_matches:
          type: array
          items:
            $ref: "#/components/schemas/QueryShortestPathItem"
          x-field-uid: 3
    QueryAttribute:
      type: object
      properties:
        name:
          type: string
          x-field-uid: 1
        operator:
          type: string
          x-field-uid: 2
          x-enum:
            eq:
              x-field-uid: 1
            regex:
              x-field-uid: 2
            contains:
              x-field-uid: 3
        value:
          type: string
          x-field-uid: 3
        logic:
          type: string
          x-field-uid: 4
          x-enum:
            and:
              x-field-uid: 1
            or:
              x-field-uid: 2
    QueryNodeId:
      type: object
      properties:
        operator:
          type: string
          x-field-uid: 1
          x-enum:
            eq:
              x-field-uid: 1
            regex:
              x-field-uid: 2
            contains:
              x-field-uid: 3
        value:
          type: string
          x-field-uid: 2
        logic:
          type: string
          x-field-uid: 3
          x-enum:
            and:
              x-field-uid: 1
            or:
              x-field-uid: 2
    QueryNodeFilter:
      type: object
      properties:
        name:
          type: string
          x-field-uid: 1
        choice:
          type: string
          x-field-uid: 2
          x-enum:
            attribute_filter:
              x-field-uid: 1
            id_filter:
              x-field-uid: 2
        attribute_filter:
          $ref: "#/components/schemas/QueryAttribute"
          x-field-uid: 3
        id_filter:
          $ref: "#/components/schemas/QueryNodeId"
          x-field-uid: 4
    QueryShortestPathFilter:
      type: object
      required:
        - name
        - source
        - destination
      properties:
        name:
          type: string
          x-field-uid: 1
        source:
          type: string
          x-field-uid: 2
        destination:
          type: string
          x-field-uid: 3
    QueryRequest:
      type: object
      properties:
        choice:
          type: string
          x-field-uid: 1
          x-enum:
            node_filters:
              x-field-uid: 1
            shortest_path_filters:
              x-field-uid: 2
        node_filters:
          type: array
          items:
            $ref: "#/components/schemas/QueryNodeFilter"
          x-field-uid: 2
        shortest_path_filters:
          description: |-
            Add shortest path filters to retrive the shortest path between source and destination nodes
          type: array
          items:
            $ref: "#/components/schemas/QueryShortestPathFilter"
          x-field-uid: 3
          x-status:
            status: under_review
            information: |-
              Proposal to abstract the shortest path interface to the graph.
  responses:
    QueryResponse:
      description: |-
        Answer to the query request.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/QueryResponseContent'